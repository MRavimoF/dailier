<html>

<head>
	<style>
		#participants span {
			padding: 0.5rem;
			margin-bottom: 0.5rem;
		}
	</style>
	<title>Dailier Meeting</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.5.3/css/foundation.min.css" />
</head>

<body>
	<div class="grid-x">
		<div class="cell medium-4">
			<div class="card">
				<div class="card-section">
					<ul class="vertical menu	">
						<div id="participants"></div>
					</ul>
				</div>
			</div>

			<div class="progress success">
				<div class="progress-meter" style="width: 67%">
					<p class="progress-meter-text">2m 25s</p>
				</div>
			</div>
		</div>
		<div class="cell medium-8">
			<table>
				<thead>
					<tr>
						<th width="200">Participant</th>
						<th>Yesterday</th>
						<th>Today</th>
						<th width="150">Blockers</th>
					</tr>
				</thead>
				<tbody id="transcript"> </tbody>
			</table>

		</div>
	</div>
</body>



<script>

	const reloadDelay = 1000;
	setTimeout(function () {
		update();
	}, reloadDelay);

	function update() {
		getData("daily", data => {
			document.getElementById("transcript").innerHTML =
				data.report
					.map(i => `<tr>
									<td>${i.participant}</td>
									<td>${i.yesterday}</td>
									<td>${i.today}</td>
									<td>${i.blockers}</td>
								</tr>`)
					.join("");
		});

		getData("participants", data => {
			document.getElementById("participants").innerHTML =
				'<ul class="vertical menu">' +
				data.participants
					.map(it => `<li><span class="label secondary">${it}</span></li> `)
					.join("") +
				"</ul>";
		});
		setTimeout(function () {
			update();
		}, reloadDelay);
	}

	function getData(resource, oncomplete) {
		var xmlhttp = new XMLHttpRequest();
		xmlhttp.onreadystatechange = function () {
			if (this.readyState == 4 && this.status == 200) {
				var myObj = JSON.parse(this.responseText);
				oncomplete(myObj);
			}
		};
		xmlhttp.open("GET", "https://dailier.herokuapp.com/" + resource, true);
		xmlhttp.send();
	}
</script>

</html>